<!DOCTYPE html>
<html lang="en">
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>文档管理系统 </title>
    <link th:href="@{/css/common.css}" rel="stylesheet" href="css/common.css" type="text/css"/>
    <link th:href="@{/css/index.css}" rel="stylesheet" href="css/index.css" type="text/css"/>
    <link th:href="@{/css/my.css}" rel="stylesheet" href="css/my.css" type="text/css" media="screen"/>
    <link th:href="@{/css/base.css}" rel="stylesheet" href="page/base.css" type="text/css" media="screen"/>
    <link th:href="@{/css/pageGroup.css}" rel="stylesheet" href="page/pageGroup.css" type="text/css" media="screen"/>
</head>
<!--顶部-->
<div class="nav">
    <div class="nav cl">
        <div class="nav_z z">
            <img th:src="@{/img/register01.png}" src="img/register01.png"/>
        </div>


        <div class="userNumber y">
            你好,<span th:text="${name}">13980510085</span>
        </div>
    </div>

</div>
<!--顶部结束-->
<!--菜单-->
<div class="left-menu">
    <div class="left-menu-top">

        <a th:href="addDocument" href="javascript:void(0)">
            <div class="left-menu-top-small">
                <img th:src="@{/img/index_02.png}" src="img/index_02.png"/>
            </div>
        </a>
    </div>
    <div class="left-menu-one">
        <a th:href="my" href="my.html">
            <div class="left-menu-one-small">
                <img th:src="@{/img/index_03_1.png}" src="img/index_03_1.png"/>
            </div>
        </a>
        <a th:href="zuijin" href="zuijin.html">
            <div class="left-menu-one-small">
                <img th:src="@{/img/index_05.png}" src="img/index_05.png"/>
            </div>
        </a>
    </div>
    <div class="left-menu-two">
        <a th:href="excel" href="excel.html">
            <div class="left-menu-two-small">
                <img th:src="@{/img/excel01.png}" src="img/excel01.png"/>
            </div>
        </a>
        <a th:href="ppt" href="ppt.html">
            <div class="left-menu-two-small">
                <img th:src="@{/img/ppt01.png}" src="img/ppt01.png"/>
            </div>
        </a>
        <a th:href="word" href="word.html">
            <div class="left-menu-two-small">
                <img th:src="@{/img/word01.png}" src="img/word01.png"/>
            </div>
        </a>
    </div>
    <div class="left-menu-three">
        <a th:href="lajixiang" href="lajixiang.html">
            <div class="left-menu-three-small">
                <img th:src="@{/img/lajixiang01.png}" src="img/lajixiang01.png"/>
            </div>
        </a>
    </div>
    <div class="left-menu-four">
        <div class="left-menu-four-small">
            <div class="left-menu-four-small-new"></div>
        </div>
        <div class="contain_four">
            <div class="contain_four_main">
                <span>容量：</span>
                <span class="cont" th:text="${cont}">5</span>GB；可用
                <span class="use" th:text="${usecont}">3</span>GB
            </div>

        </div>
    </div>


</div>
<!--菜单end-->
<!--菜单右边的iframe页面-->
<div id="right-content" class="right-content">
    <div class="content">
        <div id="page_content">
            <div class="zuijinTop cl">
                <img th:src="@{/img/xiazai.png}" src="img/xiazai.png" class="xiazai z" alt="">
                <img th:src="@{/img/chong.png}" src="img/chong.png" class="chong z" alt="">
                <img th:src="@{/img/shanchu.png}" src="img/shanchu.png" class="shanchu z" alt="">

                <div class="sousuo y">
                    <div class="ss1 z"></div>
                    <input type="text" placeholder="请输入关键字搜索文件" class="z sousouInput" />
                </div>
            </div>
            <div class="zuijinTitle cl">
                <img th:src="@{/img/select.png}" src="img/select.png" data-all="no" class="z allIcon allSelect" alt="">

            </div>
            <div class="content cl" style="padding-left: 2%;height:500px;overflow-y:auto;pisition:relative;">
                <div th:each="d: ${ds}" class="box2 template" data-show="no">
                    <img th:src="@{'/img/icon'+${d.cid}+'.png'}" src="img/icon.png" class="icon" alt="" />
                    <div>
                        <p th:text="${d.title}"></p>
                        <input type="text" class="none">
                    </div>
                    <img th:src="@{'/img/select.png'}" src="img/select.png" class="select" alt="" th:alt="${d.id}" th:title="${d.title}">
                </div>
            </div>


            <!-- 重命名窗口 -->
            <div class="moveBox none">
                <div>
                    <span class="label label-primary">重命名</span>
                    <input type="text" name="did" value="" style="display:none">
                </div>
                <div>
                    <input type="text" name="newTitle" class="form-control" value="">
                </div>
                <input type="button" class="y quxiao" value="取消">
                <input type="button" class="y ok" value="确定">
            </div>
        </div>
    </div>
</div>

<body>
<script th:src="@{js/jquery-2.2.3.min.js}" type="text/javascript" src="js/jquery-2.2.3.min.js"></script>
<script th:src="@{js/pageGroup.js}" type="text/javascript" src="page/pageGroup.js"></script>
<script th:src="@{js/index.js}" type="text/javascript" src="js/index.js"></script>
<script>
    $(".sousouInput").blur(function(){
        $(".sousuo").css({
            border:"1px solid #ccc"
        });
        $(".ss1").removeClass("focusState");
    });
    $(".sousouInput").focus(function(){
        $(".sousuo").css({
            border:"1px solid #9cf"
        });
        $(".ss1").addClass("focusState");
    });
    $(".zuijinTitle").css({
        width:$(window).width()-237
    });
    $(".content").css({
       width:$(window).width()-237
    });

    $("#page_content").css({
        width:$(window).width()-237
    });



    $(".allIcon").click(function(){
        if($(this).attr("data-all")=="yes"){
            $(this).attr("src","img/select.png");
            $(".select").attr("src","img/select.png");
            $(this).attr("data-all","no");
            $(".template").attr("data-show","no");
            $(".template").removeClass("box2H");
        }else{
            $(this).attr("src","img/selectC.png");
            $(".template").attr("data-show","yes");
            $(this).attr("data-all","yes");
            $(".template").addClass("box2H");
            $(".select").attr("src","img/selectC.png");
        }
    });

    bindMyClick();

    function  bindMyClick(){
        $(".content .template").each(function(){
           $(this).click(function(){
               if($(this).attr("data-show")=="yes"){
                   $(this).removeClass(".box2C");
                   $(this).removeClass(".box2H");
                   $(this).find(".select").attr("src","img/select.png");
                   $(this).attr("data-show","no");
//                   $(this).find(".select").hide();
               }else {
                   $(this).addClass(".box2C");
                   $(this).addClass(".box2H");
                   $(this).find(".select").attr("src","img/selectC.png");
                   $(this).attr("data-show","yes");
                   $(this).find(".select").show();
               }
           });
        });
    }


    $(".contentMain .templateUrl").each(function(e){
        $(".contentMain .templateUrl").eq(e).click(function(){
            $(".contentMain p").removeClass("templateUrlClickP");
            $(".contentMain p").eq(e).addClass("templateUrlClickP");
       });
    });

    //删除文件
    $(".shanchu").click(function () {
        var test = $("img[src='img/selectC.png']");
        if(test.size() == 0){
            alert("请选择至少1个文件");
            return;
        }
        // alert(test);
        var ids = new Array();
        for (var i=0;i<test.size();i++){
            ids.push(test[i].alt);
        }
        $.ajax({
            url: "document/goToRecycle",
            type: "GET",
            dataType:"json",
            data: {
                "ids": ids
            },
            success: function(data) {
                alert(data.msg);
                location.reload();
            }
        });
    })


    //下载文件
    $(".xiazai").click(function () {
        var test = $("img[src='img/selectC.png']");
        if(test.size() != 1){
            alert("请选择1个文件");
            return;
        }
        $.ajax({
            url: "document/downLoadFile",
            type: "GET",
            dataType:"json",
            data: {
                "id": test[0].alt
            },
            success: function(data) {
                alert(data.msg);
                location.reload();
            }
        });
    })



    //提交重命名字段新名字
    $(".ok").click(function () {
        var did = $("input[name='did']").val();
        var newTitle = $("input[name='newTitle']").val();
        //alert(did + newTitle);
        var data = {
            did : did,
            newTitle :newTitle
        };
        $.ajax({
            url: "document/updataTitle",
            data: data,
            context: document.body,
            dataType:"json",
            success: function(result){
                //alert(result.url);
                alert(result.msg);
                location.reload();
            }
        });
    });


    //获得要重命名文件数据并打开更名框
    $(".chong").click(function(){
        var test = $("img[src='img/selectC.png']");
        if(test.size()!=1){
            alert("请选择1个文件");
        }
        var did = test[0].alt;
        var newTitle = test[0].title;
        $("input[name='did']").attr("value",did);
        $("input[name='newTitle']").attr("value",newTitle);
        //alert(test.size());
        $(".moveBox").show();
    });


    $(".yidong").click(function(){
        $(".moveBox").show();
    });
        $(".closeMove,.ok,.quxiao").click(function(){
           $(".moveBox").hide();
        });
</script>
</body>
</html>

